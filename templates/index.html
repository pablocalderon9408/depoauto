{% extends 'base.html' %}
{% load static %}
{% block title %}depoauto ‚Äî Repuestos y accesorios{% endblock %}

{% block extra_head %}
<style>
    .hero-depo .carousel-caption {
        text-align: left;
    }

    @media (max-width: 767px) {
        .hero-depo .carousel-caption {
            text-align: center;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero -->
<div id="heroCarousel" class="carousel slide hero-depo mb-5" data-bs-ride="carousel">
    <div class="carousel-inner">
        {% if hero_slides %}
        {% for s in hero_slides %}
        <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <img class="w-100 d-block" src="{{ s.image_url_display }}" alt="{{ s.title|default:'Hero' }}"
                loading="eager" fetchpriority="high" width="1600" height="600">
            <div class="carousel-caption d-none d-md-block">
                {% if s.title %}<h2>{{ s.title }}</h2>{% endif %}
                {% if s.subtitle %}<p class="lead mb-3">{{ s.subtitle }}</p>{% endif %}
                <a href="{{ s.cta_url }}" class="btn btn-hero">{{ s.cta_label|default:'Ver productos' }}</a>
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div class="carousel-item active">
            <img class="w-100 d-block" src="https://picsum.photos/seed/hero-fallback/1600/600" alt="DepoAuto"
                loading="eager" fetchpriority="high" width="1600" height="600">
            <div class="carousel-caption d-none d-md-block">
                <span class="badge bg-warning text-dark mb-2 px-3 py-2">Bienvenido</span>
                <h2>Repuestos y accesorios</h2>
                <p class="lead mb-3">Calidad para tu veh√≠culo. M√°s de 30 a√±os de experiencia.</p>
                <a href="{% url 'product_list' %}" class="btn btn-hero">Ver productos</a>
            </div>
        </div>
        {% endif %}
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Siguiente</span>
    </button>
    {% if hero_slides %}
    <div class="carousel-indicators">
        {% for s in hero_slides %}
        <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
            class="{% if forloop.first %}active{% endif %}" aria-label="Slide {{ forloop.counter }}"></button>
        {% endfor %}
    </div>
    {% endif %}
</div>

<!-- KPIs -->
<div class="row row-cols-2 row-cols-md-4 g-3 mb-5">
    <div class="col">
        <div class="kpi-depo d-flex align-items-center gap-3">
            <span class="kpi-icon">üöö</span>
            <div>
                <div class="kpi-title">Env√≠os r√°pidos</div>
                <div class="kpi-sub">A todo el pa√≠s</div>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="kpi-depo d-flex align-items-center gap-3">
            <span class="kpi-icon">üõ°Ô∏è</span>
            <div>
                <div class="kpi-title">Pagos seguros</div>
                <div class="kpi-sub">Pasarelas confiables</div>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="kpi-depo d-flex align-items-center gap-3">
            <span class="kpi-icon">‚≠ê</span>
            <div>
                <div class="kpi-title">Muy valorados</div>
                <div class="kpi-sub">Por nuestros clientes</div>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="kpi-depo d-flex align-items-center gap-3">
            <span class="kpi-icon">üì¶</span>
            <div>
                <div class="kpi-title">Repuestos de calidad</div>
                <div class="kpi-sub">Selecci√≥n cuidadosa</div>
            </div>
        </div>
    </div>
</div>

<!-- Categor√≠as -->
{% if show_top_categories %}
<div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="section-header mb-0">Categor√≠as destacadas</h2>
    <a class="btn btn-depo-outline btn-sm" href="{% url 'product_list' %}">Ver todo</a>
</div>
<div class="row row-cols-2 row-cols-md-3 g-3 mb-5">
    {% for cat in top_categories %}
    <div class="col">
        <a href="{% url 'product_list_by_category' cat.slug %}" class="text-decoration-none">
            <div class="category-depo" {% if cat.image_url_display%}
                style="background-image: url('{{ cat.image_url_display }}')" {% else%}
                style="background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%)" {% endif %}>
                <span>{{ cat.name }}</span>
            </div>
        </a>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="alert alert-info">No hay categor√≠as a√∫n.</div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Novedades -->
{% if show_new_arrivals %}
<div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="section-header mb-0">Novedades</h2>
    <a class="btn btn-depo-outline btn-sm" href="{% url 'product_list' %}">Ver todos</a>
</div>
<div class="row row-cols-2 row-cols-md-4 g-3">
    {% for p in featured_products %}
    <div class="col">
        <div class="card card-depo h-100">
            <div class="ratio ratio-4x3 overflow-hidden bg-light img-reserve">
                <img class="product-img-depo" src="{{ p.image_url_display }}" alt="{{ p.name }}" loading="eager" {% if forloop.counter <= 4 %}fetchpriority="high"{% endif %} width="400" height="300">
            </div>
            <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ p.name }}</h5>
                <p class="card-text text-muted small mb-2">SKU: {{ p.sku }}</p>
                <a href="{% url 'product_detail' p.slug %}" class="btn btn-depo-primary btn-sm w-100 mt-auto">Ver
                    producto</a>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="alert alert-info">No hay productos a√∫n.</div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}